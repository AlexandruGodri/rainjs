

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Data Layer &mdash; Rain 0.10.0 documentation</title>
    
    <link rel="stylesheet" href="../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.10.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="Rain 0.10.0 documentation" href="../index.html" />
    <link rel="next" title="Platform language" href="platform_language.html" />
    <link rel="prev" title="Authorization" href="authorization.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="platform_language.html" title="Platform language"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="authorization.html" title="Authorization"
             accesskey="P">previous</a> |</li>
        <li><a href="../index.html">Rain 0.10.0 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="data-layer">
<h1>Data Layer<a class="headerlink" href="#data-layer" title="Permalink to this headline">¶</a></h1>
<p>The data layer allows developers to pass custom data to the view templates. When the template is
executed it can use this data to construct dynamic markup. The data can be obtained by calling an
web service or it can be constructed inside the data layer function.</p>
<div class="section" id="usage">
<h2>Usage<a class="headerlink" href="#usage" title="Permalink to this headline">¶</a></h2>
<p>The Handlebars context in which the component helper was used is passed to the data layer method
as the second parameter. If the <tt class="docutils literal"><span class="pre">data.js</span></tt> file or the method for the view doesn&#8217;t exist, this
data will become the context used to execute the template associated with the aggregated component.</p>
<p>Data layer methods are placed in the <tt class="docutils literal"><span class="pre">/server/data.js</span></tt> file. In order to define a data
method for a view a function with the same name as the <em>view id</em> should be created in this file and
exported as part of the public API of this module.</p>
<p>This method receives two parameters. The first parameter is a callback that is called with two
parameters: an error (or <tt class="docutils literal"><span class="pre">null</span></tt> if no error occurred) and the custom data that will be passed
to the template. The second parameter of the data layer method is the data that was passed
to the component helper.</p>
<p><tt class="docutils literal"><span class="pre">/meta.json</span></tt></p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="p">{</span>
    <span class="s2">&quot;id&quot;</span><span class="o">:</span> <span class="s2">&quot;button&quot;</span><span class="p">,</span>
    <span class="s2">&quot;version&quot;</span><span class="o">:</span> <span class="s2">&quot;1.0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;views&quot;</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;index&quot;</span> <span class="o">:</span> <span class="p">{</span>
            <span class="s2">&quot;view&quot;</span><span class="o">:</span> <span class="s2">&quot;index.html&quot;</span><span class="p">,</span>
            <span class="s2">&quot;controller&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;client&quot;</span><span class="o">:</span> <span class="s2">&quot;index.js&quot;</span><span class="p">,</span>
                <span class="s2">&quot;server&quot;</span><span class="o">:</span> <span class="s2">&quot;index.js&quot;</span>
            <span class="p">}</span>
        <span class="p">},</span>
        <span class="s2">&quot;index1&quot;</span> <span class="o">:</span> <span class="p">{</span>
            <span class="s2">&quot;view&quot;</span><span class="o">:</span> <span class="s2">&quot;index1.html&quot;</span><span class="p">,</span>
            <span class="s2">&quot;controller&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;client&quot;</span><span class="o">:</span> <span class="s2">&quot;index1.js&quot;</span><span class="p">,</span>
                <span class="s2">&quot;server&quot;</span><span class="o">:</span> <span class="s2">&quot;index1.js&quot;</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p><tt class="docutils literal"><span class="pre">/server/data.js</span></tt></p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="kd">function</span> <span class="nx">index</span><span class="p">(</span><span class="nx">callback</span><span class="p">,</span> <span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">customData</span> <span class="o">=</span> <span class="p">{</span>
        <span class="nx">field1</span><span class="o">:</span> <span class="nx">data</span><span class="p">,</span>
        <span class="nx">field2</span><span class="o">:</span> <span class="s1">&#39;value&#39;</span>
    <span class="p">};</span>

    <span class="nx">callback</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span> <span class="nx">customData</span><span class="p">);</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">index1</span><span class="p">(</span><span class="nx">callback</span><span class="p">,</span> <span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">getData</span><span class="p">(</span><span class="nx">data</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">customData</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">callback</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span> <span class="nx">customData</span><span class="p">);</span>
    <span class="p">});</span>
<span class="p">}</span>

<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="p">{</span>
    <span class="nx">index</span><span class="o">:</span> <span class="nx">index</span><span class="p">,</span>
    <span class="nx">index1</span><span class="o">:</span> <span class="nx">index1</span>
<span class="p">};</span>
</pre></div>
</div>
<div class="admonition-see-also admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="api/DataLayer.html#DataLayer" title="DataLayer"><tt class="xref js js-class docutils literal"><span class="pre">DataLayer()</span></tt></a></dt>
<dd>Data Layer API</dd>
</dl>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Data Layer</a><ul>
<li><a class="reference internal" href="#usage">Usage</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="authorization.html"
                        title="previous chapter">Authorization</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="platform_language.html"
                        title="next chapter">Platform language</a></p>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="platform_language.html" title="Platform language"
             >next</a> |</li>
        <li class="right" >
          <a href="authorization.html" title="Authorization"
             >previous</a> |</li>
        <li><a href="../index.html">Rain 0.10.0 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>